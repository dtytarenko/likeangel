(()=>{"use strict";var t=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wcus-automation"},[n("div",{staticClass:"wcus-automation__canvas-outer"},[n("div",{staticClass:"wcus-automation__canvas"},[t._l(t.components,(function(e,a){return[n("component",0===a?{key:e.id,attrs:{model:e,canDelete:t.hasEvent},on:{onFocus:function(e){return t.setState(t.hasEvent?"EVENT_EDIT":"SELECT_EVENT")},onDeleted:function(n){return t.removeComponent(e)}}}:{key:e.id,attrs:{model:e},on:{onFocus:function(n){return t.editAction(e.id)},onDeleted:function(n){return t.removeComponent(e)}}}),t._v(" "),n("gap")]})),t._v(" "),t.hasEvent?n("div",{staticClass:"wcus-automation__add-action-wrap"},[n("div",{staticClass:"wcus-automation__add-action",on:{click:function(e){return t.setState("ACTION_ADD")}}},[t._v("Add action")])]):t._e()],2)]),t._v(" "),n("div",{staticClass:"wcus-automation__sidebar"},[n("div",{staticClass:"wcus-automation__sidebar-inner"},[t.isEventSelectState?n("EventSelect"):t._e(),t._v(" "),t.isEventEditState?n("EventEdit",{key:t.event.id,attrs:{eventType:t.event.model.type,eventParams:t.event.model.params}}):t._e(),t._v(" "),"ACTION_ADD"===t.state?n("ActionAdd"):t._e(),t._v(" "),"ACTION_EDIT"===t.state?n("ActionEdit",{key:t.action.id,attrs:{actionType:t.action.model.type,actionParams:t.action.model.params}}):t._e()],1)]),t._v(" "),n("input",{attrs:{type:"hidden",name:"event_data"},domProps:{value:t.eventData}}),t._v(" "),n("input",{attrs:{type:"hidden",name:"actions_data"},domProps:{value:t.actionsData}})])};t._withStripped=!0;var e=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wcus-automation-component",class:{active:t.model.focused,"wcus-automation-component--event":"event"===t.model.type},on:{click:function(e){return t.setActive()}}},[n("div",{staticClass:"wcus-automation-component__icon"}),t._v(" "),n("div",{staticClass:"wcus-automation-component__body"},[n("div",{staticClass:"wcus-automation-component__name"},[t._v(t._s(t.model.name))]),t._v(" "),n("div",{staticClass:"wcus-automation-component__description"},[t._v(t._s(t.model.description))])]),t._v(" "),t.model.focused&&t.canDelete?n("div",{staticClass:"wcus-automation-component__remove"},[n("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.$emit("onDeleted")}}},[t._v("Remove")])]):t._e()])};e._withStripped=!0;const{mapMutations:n}=WCUkrShipping.UI;function a(t,e,n,a,s,o,i,r){var c,l="function"==typeof t?t.options:t;if(e&&(l.render=e,l.staticRenderFns=n,l._compiled=!0),a&&(l.functional=!0),o&&(l._scopeId="data-v-"+o),i?(c=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),s&&s.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(i)},l._ssrRegister=c):s&&(c=r?function(){s.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:s),c)if(l.functional){l._injectStyles=c;var u=l.render;l.render=function(t,e){return c.call(e),u(t,e)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,c):[c]}return{exports:t,options:l}}var s=a({props:{model:Object,canDelete:{type:Boolean,default:!0}},methods:{...n("automation",["clearActive"]),setActive(){this.clearActive(),this.model.focused=!0,this.$emit("onFocus")}}},e,[],!1,null,null,null);s.options.__file="frontend/js/automation/components/Component.vue";const o=s.exports;var i=function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"wcus-automation-gap"})};i._withStripped=!0;var r=a({},i,[],!1,null,null,null);r.options.__file="frontend/js/automation/components/Gap.vue";const c=r.exports;var l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wcus-automation-event-select"},t._l(t.events,(function(e){return n("div",{staticClass:"wcus-automation-event-select__item",on:{click:function(n){return t.selectEvent(e)}}},[n("div",{staticClass:"wcus-automation-event-select__icon"},[n("icon",{attrs:{name:e.icon}})],1),t._v(" "),n("div",{staticClass:"wcus-automation-event-select__name"},[t._v(t._s(e.name))])])})),0)};l._withStripped=!0;var u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return"status_changed"===t.name?n("svg",{attrs:{width:"24",viewBox:"0 0 24 24"}},[n("path",{attrs:{d:"m5 2c-1.6568 0-3 1.3432-3 3s1.3432 3 3 3 3-1.3432 3-3-1.3432-3-3-3zm0 2c0.55228 0 1 0.44772 1 1s-0.44772 1-1 1-1-0.44772-1-1 0.44772-1 1-1z",fill:"currentColor"}}),n("path",{attrs:{d:"m19 16c-1.6569 0-3 1.3431-3 3s1.3431 3 3 3 3-1.3431 3-3-1.3431-3-3-3zm0 2c0.5523 0 1 0.4477 1 1s-0.4477 1-1 1-1-0.4477-1-1 0.4477-1 1-1z",fill:"currentColor"}}),n("path",{attrs:{d:"M10 4C11.5977 4 12.9037 5.24892 12.9949 6.82373L13 7V17C13 17.5128 13.386 17.9355 13.8834 17.9933L14 18H17V20H14C12.4023 20 11.0963 18.7511 11.0051 17.1763L11 17V7C11 6.48716 10.614 6.06449 10.1166 6.00673L10 6H7V4H10Z",fill:"currentColor"}})]):"send_email"===t.name?n("svg",{attrs:{width:"24",height:"24",viewBox:"0 0 24 24",role:"presentation"}},[n("g",{attrs:{fill:"currentColor","fill-rule":"evenodd"}},[n("path",{attrs:{d:"M5 7v10h14V7H5zm14-2c1.1 0 2 .9 2 2v10c0 1.1-.9 2-2 2H5c-1.1 0-2-.9-2-2V7c0-1.1.9-2 2-2h14z","fill-rule":"nonzero"}}),n("path",{attrs:{d:"M5.498 6.5H3.124c.149.44.399.854.75 1.205l5.882 5.881a3.117 3.117 0 004.41 0l5.882-5.881c.35-.351.6-.765.749-1.205h-2.373l-5.672 5.672a1.119 1.119 0 01-1.583 0L5.498 6.5z"}})])]):"update_order_status"===t.name?n("svg",{attrs:{height:"24",width:"24",viewBox:"0 0 24 24"}},[n("path",{attrs:{d:"m16 3h-8c-0.55228 0-1 0.44772-1 1s0.44772 1 1 1h8c0.5523 0 1-0.44772 1-1s-0.4477-1-1-1z",fill:"currentColor"}}),n("path",{attrs:{d:"m18 19h-12c-0.55228 0-1 0.4477-1 1s0.44772 1 1 1h12c0.5523 0 1-0.4477 1-1s-0.4477-1-1-1z",fill:"currentColor"}}),n("path",{attrs:{d:"m12 7c0.5523 0 1 0.44772 1 1v4h-2v-4c0-0.55228 0.4477-1 1-1z","clip-rule":"evenodd",fill:"currentColor","fill-rule":"evenodd"}}),n("path",{attrs:{d:"m11.735 16.518-3.0585-3.6995c-0.17595-0.2128-0.14606-0.528 0.06677-0.704 0.08963-0.0741 0.20229-0.1146 0.31859-0.1146h5.9192c0.2762 0 0.5 0.2239 0.5 0.5 0 0.1107-0.0367 0.2183-0.1044 0.3058l-2.8607 3.6996c-0.1689 0.2184-0.4829 0.2586-0.7014 0.0896-0.0292-0.0226-0.0559-0.0484-0.0795-0.0769z","clip-rule":"evenodd",fill:"currentColor","fill-rule":"evenodd"}})]):"pen"===t.name?n("svg",{attrs:{width:"24",height:"24",viewBox:"0 0 24 24",role:"presentation"}},[n("path",{attrs:{d:"M4.02 19.23a1 1 0 001.18 1.18l3.81-.78-4.21-4.21-.78 3.81zM19.844 6.707l-2.12-2.122A1.997 1.997 0 0016.308 4c-.512 0-1.024.195-1.415.585l-9.757 9.758 4.95 4.95 9.757-9.758a2 2 0 000-2.828z",fill:"currentColor","fill-rule":"evenodd"}})]):"document"===t.name?n("svg",{attrs:{width:"24",height:"24",viewBox:"0 0 24 24",role:"presentation"}},[n("g",{attrs:{fill:"currentColor","fill-rule":"evenodd"}},[n("rect",{attrs:{x:"8",y:"6",width:"8",height:"2",rx:"1"}}),n("rect",{attrs:{x:"8",y:"9",width:"8",height:"2",rx:"1"}}),n("rect",{attrs:{x:"8",y:"12",width:"4",height:"2",rx:"1"}}),n("path",{attrs:{d:"M7 4v16h10V4H7zm-2-.01C5 2.892 5.897 2 7.006 2h9.988C18.102 2 19 2.898 19 3.99v16.02c0 1.099-.897 1.99-2.006 1.99H7.006A2.003 2.003 0 015 20.01V3.99z","fill-rule":"nonzero"}})])]):t._e()};u._withStripped=!0;var d=a({props:{name:String}},u,[],!1,null,null,null);d.options.__file="frontend/js/automation/components/sidebar/icon.vue";const v=d.exports,_={cloud_status_changed:{type:"cloud_status_changed",name:"Cloud tracking status changed",description:"",icon:"status_changed",defaults:{newStatus:"PACKAGING"}},carrier_status_changed:{type:"carrier_status_changed",name:"Carrier tracking status changed",description:"",icon:"status_changed",defaults:{newStatus:["1"]}},ttn_created:{type:"ttn_created",name:"TTN created",description:"Fires when new TTN was created for order",icon:"document",defaults:{}},ttn_attached:{type:"ttn_attached",name:"TTN attached",description:"Fires when new TTN was attached for order",icon:"document",defaults:{}},ttn_deleted:{type:"ttn_deleted",name:"TTN deleted",description:"Fires when new TTN was deleted",icon:"document",defaults:{}}},p={send_email:{type:"send_email",name:"Send email",description:"",icon:"send_email",defaults:{destination:"customer",subject:"Your tracking status was updated",message:"Dear {{billing_firstname}} {{billing_lastname}}. You tracking has new status - {{ttn_status_code}}"}},update_order_status:{type:"update_order_status",name:"Update order status",description:"",icon:"update_order_status",defaults:{newStatus:"wc-on-hold"}},add_order_note:{type:"add_order_note",name:"Add order note",description:"",icon:"pen",defaults:{message:"Example"}}},{mapMutations:m}=WCUkrShipping.UI;var f=a({components:{Icon:v},computed:{events:()=>_},methods:{...m("automation",["updateEvent"]),selectEvent(t){this.updateEvent(t)}}},l,[],!1,null,null,null);f.options.__file="frontend/js/automation/components/sidebar/EventSelect.vue";const h=f.exports;var g=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wcus-control-group"},[n("div",{staticClass:"wcus-control-group__title"},[t._v("Event settings")]),t._v(" "),n("div",{staticClass:"wcus-control-group__content"},["cloud_status_changed"===t.eventType?n("div",[n("div",{staticClass:"wcus-form-group"},[n("label",{attrs:{for:"new_status"}},[t._v("New status")]),t._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:t.eventParams.newStatus,expression:"eventParams.newStatus"}],staticClass:"wcus-form-control",attrs:{id:"new_status",name:"params[new_status]"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.eventParams,"newStatus",e.target.multiple?n:n[0])}}},[n("option",{attrs:{value:"PENDING"}},[t._v("PENDING")]),t._v(" "),n("option",{attrs:{value:"INFO_RECEIVED"}},[t._v("INFO_RECEIVED")]),t._v(" "),n("option",{attrs:{value:"PACKAGING"}},[t._v("PACKAGING")]),t._v(" "),n("option",{attrs:{value:"IN_TRANSIT"}},[t._v("IN_TRANSIT")]),t._v(" "),n("option",{attrs:{value:"AVAILABLE_FOR_PICKUP"}},[t._v("AVAILABLE_FOR_PICKUP")]),t._v(" "),n("option",{attrs:{value:"DELIVERED"}},[t._v("DELIVERED")]),t._v(" "),n("option",{attrs:{value:"EXCEPTION"}},[t._v("EXCEPTION")])])])]):"carrier_status_changed"===t.eventType?n("div",[n("div",{staticClass:"wcus-form-group"},[n("label",{attrs:{for:"new_status"}},[t._v("New status")]),t._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:t.eventParams.newStatus,expression:"eventParams.newStatus"}],staticClass:"wcus-form-control",staticStyle:{"max-width":"100%",height:"400px!important"},attrs:{id:"new_status",name:"params[new_status]",multiple:""},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.eventParams,"newStatus",e.target.multiple?n:n[0])}}},[n("option",{attrs:{value:"1"}},[t._v("[1] Відправник самостійно створив цю накладну, але ще не надав до відправки")]),t._v(" "),n("option",{attrs:{value:"2"}},[t._v("[2] Видалено")]),t._v(" "),n("option",{attrs:{value:"3"}},[t._v("[3] Номер не знайдено")]),t._v(" "),n("option",{attrs:{value:"4"}},[t._v("[4] Відправлення у місті ХХXХ. (Статус для межобластных отправлений)")]),t._v(" "),n("option",{attrs:{value:"41"}},[t._v("[41] Відправлення у місті ХХXХ. (Статус для услуг локал стандарт и локал экспресс - доставка в пределах города)")]),t._v(" "),n("option",{attrs:{value:"5"}},[t._v("[5] Відправлення прямує до міста YYYY")]),t._v(" "),n("option",{attrs:{value:"6"}},[t._v("[6] Відправлення у місті YYYY, орієнтовна доставка до ВІДДІЛЕННЯ-XXX dd-mm. Очікуйте додаткове повідомлення про прибуття")]),t._v(" "),n("option",{attrs:{value:"7"}},[t._v("[7] Прибув на відділення")]),t._v(" "),n("option",{attrs:{value:"8"}},[t._v("[8] Прибув на відділення (завантажено в Поштомат)")]),t._v(" "),n("option",{attrs:{value:"9"}},[t._v("[9] Відправлення отримано")]),t._v(" "),n("option",{attrs:{value:"10"}},[t._v("[10] Відправлення отримано %DateReceived%. Протягом доби ви одержите SMS-повідомлення про надходження грошового переказу та зможете отримати його в касі відділення «Нова пошта»")]),t._v(" "),n("option",{attrs:{value:"11"}},[t._v("[11] Відправлення отримано %DateReceived%. Грошовий переказ видано одержувачу.")]),t._v(" "),n("option",{attrs:{value:"12"}},[t._v("[12] Нова Пошта комплектує ваше відправлення")]),t._v(" "),n("option",{attrs:{value:"101"}},[t._v("[101] На шляху до одержувача")]),t._v(" "),n("option",{attrs:{value:"102"}},[t._v("[102] Відмова від отримання (Відправником створено замовлення на повернення)")]),t._v(" "),n("option",{attrs:{value:"103"}},[t._v("[103] Відмова одержувача (отримувач відмовився від відправлення)")]),t._v(" "),n("option",{attrs:{value:"104"}},[t._v("[104] Змінено адресу")]),t._v(" "),n("option",{attrs:{value:"105"}},[t._v("[105] Припинено зберігання")]),t._v(" "),n("option",{attrs:{value:"106"}},[t._v("[106] Одержано і створено ЄН зворотньої доставки")]),t._v(" "),n("option",{attrs:{value:"111"}},[t._v("[111] Невдала спроба доставки через відсутність Одержувача на адресі або зв'язку з ним")]),t._v(" "),n("option",{attrs:{value:"112"}},[t._v("[112] Дата доставки перенесена Одержувачем")])])])]):n("div",[t._v("\n      There are no settings for this event\n    ")])])])};g._withStripped=!0;const{mapMutations:w}=WCUkrShipping.UI;var C=a({props:{eventType:String,eventParams:Object}},g,[],!1,null,null,null);C.options.__file="frontend/js/automation/components/sidebar/EventEdit.vue";const E=C.exports;var S=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wcus-automation-event-select wcus-automation-event-select--action"},t._l(t.actions,(function(e){return n("div",{staticClass:"wcus-automation-event-select__item",on:{click:function(n){return t.addAction(e)}}},[n("div",{staticClass:"wcus-automation-event-select__icon"},[n("icon",{attrs:{name:e.icon}})],1),t._v(" "),n("div",{staticClass:"wcus-automation-event-select__name"},[t._v(t._s(e.name))])])})),0)};S._withStripped=!0;const{mapMutations:y}=WCUkrShipping.UI;var x=a({components:{Icon:v},computed:{actions:()=>p},methods:{...y("automation",["addAction"])}},S,[],!1,null,null,null);x.options.__file="frontend/js/automation/components/sidebar/ActionAdd.vue";const T=x.exports;var P=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wcus-control-group"},[n("div",{staticClass:"wcus-control-group__title"},[t._v("Action settings")]),t._v(" "),n("div",{staticClass:"wcus-control-group__content"},["send_email"===t.actionType?n("div",[n("div",{staticClass:"wcus-form-group"},[n("label",{attrs:{for:"wcus_automation_destination"}},[t._v("Destination")]),t._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:t.actionParams.destination,expression:"actionParams.destination"}],key:"edit_destination",staticClass:"wcus-form-control",attrs:{id:"wcus_automation_destination"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.actionParams,"destination",e.target.multiple?n:n[0])}}},[n("option",{attrs:{value:"customer"}},[t._v("Customer")]),t._v(" "),n("option",{attrs:{value:"admin"}},[t._v("Administrator")])])]),t._v(" "),n("div",{staticClass:"wcus-form-group"},[n("label",{attrs:{for:"wcus_automation_subject"}},[t._v("Subject")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.actionParams.subject,expression:"actionParams.subject"}],staticClass:"wcus-form-control",attrs:{type:"text",id:"wcus_automation_subject"},domProps:{value:t.actionParams.subject},on:{input:function(e){e.target.composing||t.$set(t.actionParams,"subject",e.target.value)}}})]),t._v(" "),n("div",{staticClass:"wcus-form-group"},[n("label",{attrs:{for:"wcus_automation_message"}},[t._v("Message")]),t._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.actionParams.message,expression:"actionParams.message"}],staticClass:"wcus-form-control",staticStyle:{height:"150px"},attrs:{id:"wcus_automation_message"},domProps:{value:t.actionParams.message},on:{input:function(e){e.target.composing||t.$set(t.actionParams,"message",e.target.value)}}}),t._v(" "),n("div",{staticClass:"wcus-form-group__tooltip"},[n("div",[n("strong",{domProps:{textContent:t._s("{{ttn_number}}")}}),t._v(" - TTN number")]),t._v(" "),n("div",[n("strong",{domProps:{textContent:t._s("{{ttn_status_code}}")}}),t._v(" - TTN carrier status code")]),t._v(" "),n("div",[n("strong",{domProps:{textContent:t._s("{{order_id}}")}}),t._v(" - ID of WC order")]),t._v(" "),n("div",[n("strong",{domProps:{textContent:t._s("{{billing_firstname}}")}}),t._v(" - Order billing firstname")]),t._v(" "),n("div",[n("strong",{domProps:{textContent:t._s("{{billing_lastname}}")}}),t._v(" - Order billing lastname")]),t._v(" "),n("div",[n("strong",{domProps:{textContent:t._s("{{city}}")}}),t._v(" - Shipping city")]),t._v(" "),n("div",[n("strong",{domProps:{textContent:t._s("{{address}}")}}),t._v(" - Shipping address")])])])]):t._e(),t._v(" "),"update_order_status"===t.actionType?n("div",[n("div",{staticClass:"wcus-form-group"},[n("label",{attrs:{for:"wcus_automation_status"}},[t._v("New status")]),t._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:t.actionParams.newStatus,expression:"actionParams.newStatus"}],staticClass:"wcus-form-control",attrs:{id:"wcus_automation_status"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.actionParams,"newStatus",e.target.multiple?n:n[0])}}},t._l(t.orderStatuses,(function(e,a){return n("option",{domProps:{value:a}},[t._v(t._s(e))])})),0)])]):t._e(),t._v(" "),"add_order_note"===t.actionType?n("div",[n("div",{staticClass:"wcus-form-group"},[n("label",{attrs:{for:"wcus_automation_note"}},[t._v("Message")]),t._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.actionParams.message,expression:"actionParams.message"}],staticClass:"wcus-form-control",staticStyle:{height:"150px"},attrs:{id:"wcus_automation_note"},domProps:{value:t.actionParams.message},on:{input:function(e){e.target.composing||t.$set(t.actionParams,"message",e.target.value)}}}),t._v(" "),n("div",{staticClass:"wcus-form-group__tooltip"},[n("div",[n("strong",{domProps:{textContent:t._s("{{ttn_number}}")}}),t._v(" - TTN number")]),t._v(" "),n("div",[n("strong",{domProps:{textContent:t._s("{{ttn_status_code}}")}}),t._v(" - TTN carrier status code")]),t._v(" "),n("div",[n("strong",{domProps:{textContent:t._s("{{order_id}}")}}),t._v(" - ID of WC order")]),t._v(" "),n("div",[n("strong",{domProps:{textContent:t._s("{{billing_firstname}}")}}),t._v(" - Order billing firstname")]),t._v(" "),n("div",[n("strong",{domProps:{textContent:t._s("{{billing_lastname}}")}}),t._v(" - Order billing lastname")]),t._v(" "),n("div",[n("strong",{domProps:{textContent:t._s("{{city}}")}}),t._v(" - Shipping city")]),t._v(" "),n("div",[n("strong",{domProps:{textContent:t._s("{{address}}")}}),t._v(" - Shipping address")])])])]):t._e()])])};P._withStripped=!0;var N=a({props:{id:Number,actionType:String,actionParams:Object},computed:{orderStatuses:()=>wc_ukr_shipping_globals.orderStatuses}},P,[],!1,null,null,null);N.options.__file="frontend/js/automation/components/sidebar/ActionEdit.vue";const b=N.exports,{mapState:A,mapGetters:I,mapMutations:j}=WCUkrShipping.UI;var D=a({components:{Component:o,Gap:c,EventSelect:h,EventEdit:E,ActionAdd:T,ActionEdit:b},data:()=>({eventStub:{id:0,name:"Select event",description:"Select event that triggers rule",active:!0}}),computed:{...A("automation",["actions","components","state"]),...I("automation",["event","action","hasEvent","isEventSelectState","isEventEditState","eventData","actionsData"])},methods:{...j("automation",["addAction","removeEvent","removeComponentById","setState","editAction"]),removeComponent(t){"event"===t.type?this.removeEvent():(this.setState(""),this.removeComponentById(t.id))}}},t,[],!1,null,null,null);D.options.__file="frontend/js/automation/App.vue";const O=D.exports;let k=0;function V(){return++k}const $={state:{components:[{id:V(),name:"Select event",description:"Select event that triggers rule",focused:!0,type:"event",model:{type:"",params:{}}}],state:"SELECT_EVENT",isEventExist:!1,editId:0},getters:{event:t=>t.components[0],action(t){for(let e=0;e<t.components.length;e++)if(t.components[e].id===t.editId)return t.components[e];return null},hasEvent:t=>t.isEventExist,isEventSelectState:t=>"SELECT_EVENT"===t.state,isEventEditState:t=>"EVENT_EDIT"===t.state,eventData:t=>t.isEventExist?JSON.stringify(t.components[0].model):"",actionsData(t){if(t.components.length<2)return"";const e=[];for(let n=1;n<t.components.length;n++)e.push(t.components[n].model);return JSON.stringify(e)}},mutations:{clearActive(t){t.components.forEach((t=>t.focused=!1))},addAction(t,e){e=JSON.parse(JSON.stringify(e)),t.components.push({id:V(),focused:!1,name:e.name,description:e.description,type:"action",model:{type:e.type,params:e.defaults}})},updateEvent(t,e){e=JSON.parse(JSON.stringify(e)),t.components[0].name=e.name,t.components[0].description=e.description,t.components[0].model={type:e.type,params:e.defaults},t.isEventExist=!0,t.state="EVENT_EDIT"},removeEvent(t){t.components[0].name="Select event",t.components[0].description="Select event that triggers rule",t.state="SELECT_EVENT",t.isEventExist=!1},removeComponentById(t,e){for(let n=0;n<t.components.length;n++)if(t.components[n].id===e)return void t.components.splice(n,1)},setState(t,e){t.state=e},editAction(t,e){t.editId=e,t.state="ACTION_EDIT"}}},U=new function(){return new class{constructor(t){window.jQuery||console.error("jQuery not found."),this.config=t,this.xhr=null,this.config.globals||(this.config.globals={})}async post(t,e){const n=window.jQuery,a=this;return new Promise((function(s,o){a.xhr=n.ajax({method:"POST",url:a.config.url,data:Object.assign({action:t},a.config.globals,e),dataType:"json",success:function(t){a.xhr=null,s(t)},error:function(t,e,n){a.xhr=null,o({jqXHR:t,textStatus:e,errorThrown:n})}})}))}async postCors(t,e){const n=window.jQuery,a=this;return new Promise((function(s,o){a.xhr=n.ajax({method:"POST",url:t,data:JSON.stringify(e),dataType:"json",contentType:"applicat3ion/json",timeout:3e3,success:function(t){a.xhr=null,s(t)},error:function(t,e,n){a.xhr=null,o({jqXHR:t,textStatus:e,errorThrown:n})}})}))}abort(){this.xhr&&(this.xhr.abort(),this.xhr=null)}}({url:wc_ukr_shipping_globals.ajaxUrl,globals:{_token:wc_ukr_shipping_globals.nonce,lang:wc_ukr_shipping_globals.lang}})};var z;z=jQuery,window.WcusAutomation={init:function(t){if(t){const e=[],n=function(t){const e=_[t]||null;return e?JSON.parse(JSON.stringify(e)):null}(t.event.type);null!==n&&(e.push({id:V(),name:n.name,description:n.description,focused:!0,type:"event",model:{type:t.event.type,params:Object.assign(n.defaults,t.event.params)}}),$.state.isEventExist=!0,$.state.state=""),t.actions.length>0&&t.actions.forEach((t=>{const n=function(t){const e=p[t]||null;return e?JSON.parse(JSON.stringify(e)):null}(t.name);null!==n&&e.push({id:V(),name:n.name,description:n.description,focused:!1,type:"action",model:{type:n.type,params:Object.assign(n.defaults,t.action_data)}})})),e.length>0&&($.state.components=e)}WCUkrShipping.UI.registerStore("automation",$),WCUkrShipping.UI.createApp("#wcus-automation-app",{render:t=>t(O)}),z("#wcus-automation-rule-form").on("submit",(async function(t){t.preventDefault(),z(this).children(".wcus-settings").addClass("wcus-state-loading");try{const t=await U.post("wcus_automation_save_rule",{form_data:z(this).serialize()});t.success?location.href=wc_ukr_shipping_globals.adminUrl+"admin.php?page=wcus_automation_rule_edit&success=1&id="+t.data.id:(z(this).children(".wcus-settings").removeClass("wcus-state-loading"),alert(t.errors.join("\n")))}catch(t){z(this).children(".wcus-settings").removeClass("wcus-state-loading"),alert("Internal server error")}}))}},z((function(){setTimeout((()=>{z("#wcus-automation-success").fadeOut()}),2e3)}))})();